<div class="container-fluid">

  <%= form_tag 'recipes', method: :get, :class => 'search-section' do %>
    <div class="col-md-3">
      <%= select :recipe, :prep_time, Recipe::PREP_TIMES, {include_blank: "Prep Time"}, class: "form-control"%>
    </div>

    <div class="col-md-3">
      <%= select :recipe, :meal_type, Recipe::MEAL_TYPES, {include_blank: "Meal Type"}, class: "form-control"%>
    </div>

    <div class="col-md-3">
      <%= select :recipe, :ingredient_type_picker, Ingredient::INGREDIENT_TYPES, {include_blank: "Ingredient Type"}, class: "form-control"%>
    </div>

    <%= submit_tag 'Search' , class: "btn btn-default" %>
    <button class= "btn btn-primary" ><%=link_to("Show All", recipes_path)%></button>
  <% end %>
</div>

  <%= form_tag 'recipes', method: :get, :class => 'search-section' do %>
    <div class="col-md-12">
      <%= text_field_tag 'search_by_all', nil, placeholder: 'Search By Recipe Name or Ingredient', size: 33 %>


      <%= select_tag 'search_by_time', "<option value='900'>15 minutes</option><option value='1800'>30 minutes</option><option value='3600'>1 hour</option><option value='7200'>2 hours</option>".html_safe %>

      <%= select_tag 'search_by_diet', "<option value='396^Gluten-Free'>Gluten-Free</option><option value='396^Dairy-Free'>Dairy-Free</option>".html_safe, multiple: true %>

      <%= submit_tag 'Search' , class: "btn btn-default" %>
    </div>


  
<% end %>


<div class="container-fluid">
  <table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Directions</th>
        <th>Prep time</th>
        <th>Meal type</th>
        <th>Shopping List</th>
        <th>Favourites</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @recipes.each do |recipe| %>
        <tr>
          <td><%= recipe.name %></td>
          <td><%= recipe.instructions %></td>
          <td><%= recipe.prep_time %> min</td>
          <td><%= recipe.meal_type %></td>
          <%= render 'view_recipe', recipe: recipe %>
          <% if current_user.admin_user? then %>
            <%= render 'change_recipe', recipe: recipe %>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>

  <br>

  <% if current_user.admin_user? then %>
    <%= link_to 'New Recipe', new_recipe_path %>
  <% end %>

</div>

<div class="container-fluid">
  
  <div class="recipe-tile-row">
    <% @results.each do |recipe| %>
      <div class="recipe-item">
        <div class="well recipe-well">


         <!--  Looks to see if a url to image is present. Replaces size from 90x90 to 300 -->
          <% if recipe.images.first.small_url.present? %>
            <%= link_to Yummly.find(recipe.id).json["source"]["sourceRecipeUrl"] do %>
              <%= image_tag(recipe.images.first.small_url.sub("=s90", "=s300"), :alt => "") %>
            <% end %>
            
          <% else %>
            <%= image_tag("basil-bucket.jpg", :alt => "") %>
          <% end %>

          <%= render 'actions_for_recipe', recipe: recipe %>


         <h3><%= recipe.recipe_name %></h3>
          <% if recipe.total_time_in_seconds.present? %>
            <p>Prep Time: <%= recipe.total_time_in_seconds/60 %> min </p>
          <% end %>

          <% if recipe.attributes["course"].present? %>
            <p>Meal Type: <%= recipe.attributes["course"].first %></p>
          <% end %>



        
          

          
         

          
        </div>
      </div>
    <% end %>

  </div>
</div>



